[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/post-with-code/meta_analysis.html",
    "href": "posts/post-with-code/meta_analysis.html",
    "title": "Metagenomic Analysis of Gut Microbiome for their Association with Colorectal Cancer",
    "section": "",
    "text": "This post delves into the field of bioinformatics to illustrate the potential of metagenomic data to predict colorectal cancer. Metagenomics data are produced by high-throughput sequencing machines and typically require a substantial amount of compute and storage resources.\nIn this post, we will utilize processed metagenomics data from different cohorts on colorectal cancer. The dataset (relative abundance) is available here.\nThe relative abundance dataset contains samples from datasets from previous research studies as well as their own datasets. The below table provides a summary of cohorts and their information."
  },
  {
    "objectID": "posts/post-with-code/meta_analysis.html#accessing-abundance-data",
    "href": "posts/post-with-code/meta_analysis.html#accessing-abundance-data",
    "title": "Metagenomic Analysis of Gut Microbiome for their Association with Colorectal Cancer",
    "section": "Accessing abundance data",
    "text": "Accessing abundance data\nHere, we will utilize publicly available processed data of all aforementioned publications. The dataset is publicly available and can be downloaded from here.\nLet’s load the dataset first and then explore it a bit.\n\nLoading the dataset\n\n\nShow the code\nimport pandas as pd\nimport seaborn as sns\ndata = pd.read_csv('Nine_CRC_cohorts_taxon_profiles.tsv',sep='\\t',header=None).T\ndata = data.rename(columns=data.loc[0]).drop(0, axis=0)\ndata.head(5)\n\n\n\n\n\n\n\n\n\ndataset_name\nsampleID\nsubjectID\nbody_site\nstudy_condition\ndisease\nage\nage_category\ngender\ncountry\n...\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Circoviridae|g__Gyrovirus|s__Chicken_anemia_virus\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Geminiviridae|g__Mastrevirus|s__Wheat_dwarf_virus\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Hepadnaviridae|g__Orthohepadnavirus|s__Orthohepadnavirus_unclassified\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Inoviridae|g__Inovirus|s__Enterobacteria_phage_I2_2\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Inoviridae|g__Inovirus|s__Enterobacteria_phage_If1\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Polyomaviridae|g__Polyomavirus|s__JC_polyomavirus\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Retroviridae|g__Gammaretrovirus|s__Porcine_type_C_oncovirus\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Retroviridae|g__Retroviridae_noname|s__Avian_endogenous_retrovirus_EAV_HP\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Viruses_noname|g__Viruses_noname|s__Enterobacteria_phage_HK544\nk__Viruses|p__Viruses_noname|c__Viruses_noname|o__Viruses_noname|f__Viruses_noname|g__Viruses_noname|s__Porcine_stool_associated_circular_virus_3\n\n\n\n\n1\nZellerG_2014\nCCIS27304052ST-3-0\nFR-001\nstool\ncontrol\nnone\n52\nadult\nfemale\nFRA\n...\n0.0\n0.61117\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n2\nZellerG_2014\nCCIS13047523ST-4-0\nFR-003\nstool\ncontrol\nnone\n70\nsenior\nmale\nFRA\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0038\n0.0\n0.0\n0.0\n\n\n3\nZellerG_2014\nCCIS15794887ST-4-0\nFR-024\nstool\ncontrol\nnone\n37\nadult\nfemale\nFRA\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n4\nZellerG_2014\nCCIS94603952ST-4-0\nFR-025\nstool\ncontrol\nnone\n80\nsenior\nfemale\nFRA\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n5\nZellerG_2014\nCCIS74726977ST-3-0\nFR-026\nstool\nadenoma\nadenoma\n66\nsenior\nmale\nFRA\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n\n\n5 rows × 829 columns\n\n\n\nThe processed dataset contains metadata information such as body_site, study_condition along with abundance data of microbial species.\nWe will first start with Zeller et al., 2014 dataset. For that we will perform filtering based on dataset name and extract Bacteria kingdom only.\n\n\nShow the code\n# accessing Zeller et al., 2014 dataset\nzeller_db = data.loc[data['dataset_name'] == 'ZellerG_2014',:]\n\n# fetching microbacterial organism information-related columns\nbacteria_colnames = [col for col in data.columns if 'k__Bacteria' in col]\n\n# metadata colnames\nmetadata_colnames = ['dataset_name', 'sampleID', 'subjectID', 'body_site', 'study_condition',\n       'disease', 'age', 'age_category', 'gender', 'country']\n\n# dataframe with bacterial species\nzeller_b = zeller_db[bacteria_colnames + ['subjectID']]\n\n#zeller_b.columns = bacteria_colnames + ['subjectID']\n\n\n# functions to process the data and prepare in a format supporting phyloseq analysis\ndef get_sample_table(df):\n    df = df[metadata_colnames]\n    df = df.set_index('subjectID')\n    df.drop(['dataset_name','sampleID'],axis=1,inplace=True)\n    return df\n\ndef get_otu_table(df):\n    df = df[bacteria_colnames + ['subjectID']]\n    df.columns = [\"OTU_{}\".format(str(ind)) for ind, col in enumerate(bacteria_colnames)] + ['subjectID']\n    new_header = df['subjectID']\n    df_new = df.drop(['subjectID'],axis=1)\n    df_t = df_new.T\n    df_t.columns = new_header\n    return df_t\n\ndef get_taxa_table(list_of_otus):\n    otu = 0\n    mapping = {}\n    taxa_cols = ['kingdom','phylum','class','order','family','genus','species']\n    df = pd.DataFrame(columns=taxa_cols)\n    otu_mapping = {}\n    otu_ids = []\n    for ind, otu in enumerate(list_of_otus):\n        tmp = {}\n        for col in taxa_cols:\n            tmp[col] = get_specific_label(otu, col)\n        tmp_df = pd.DataFrame([tmp])\n        df = pd.concat([df,tmp_df], ignore_index=[0])\n\n        otu_id = \"OTU_{}\".format(str(ind))\n        otu_mapping[otu] = otu_id\n        otu_ids.append(otu)\n\n    df['OTU'] = ['OTU_{}'.format(str(ind)) for ind in df.index]\n    df = df.set_index('OTU')\n    return df\n\n\ndef get_specific_label(l, t):\n    \"\"\"\n    This function parse the taxonomic assignment lable and fetch the specified information (e.g., kingdom, family)\n\n    Args:\n        l (str): string of taxonomy\n        t (str): string specifying the requested information (e.g., kingdom, family, genus, etc.)\n\n    Returns:\n        str: requested heirarichal info \n    \"\"\"\n    taxa_order = {'kingdom':0,'phylum':1,'class':2,'order':3,'family':4,'genus':5,'species':6}\n\n    try:\n        specific_label = l.split('|')[taxa_order[t]]\n\n        return specific_label.strip().split('__')[1]\n    except:\n        return 'Unknown'\n\n# Seperating data into different files\notu_table = get_otu_table(zeller_db)\ntaxa_table = get_taxa_table(bacteria_colnames)\nsample_table = get_sample_table(zeller_db)\n\notu_table.to_csv('otu_table.csv')\ntaxa_table.to_csv('taxa_table.csv')\nsample_table.to_csv('sample_table.csv')\n\n\n\nOTU table\n\n\n\n\n\n\n\n\nsubjectID\nFR-001\nFR-003\nFR-024\nFR-025\nFR-026\nFR-027\nFR-030\nFR-039\nFR-040\nFR-051\n...\nFR-824\nFR-825\nFR-826\nFR-827\nFR-828\nFR-829\nFR-830\nFR-835\nFR-901\nFR-902\n\n\n\n\nOTU_0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\nOTU_1\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\nOTU_2\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\nOTU_3\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\nOTU_4\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n...\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n\n\n5 rows × 156 columns\n\n\n\n\n\nTaxonomy heirarchy table\n\n\n\n\n\n\n\n\n\nkingdom\nphylum\nclass\norder\nfamily\ngenus\nspecies\n\n\nOTU\n\n\n\n\n\n\n\n\n\n\n\nOTU_0\nBacteria\nAcidobacteria\nAcidobacteriia\nAcidobacteriales\nAcidobacteriaceae\nGranulicella\nGranulicella_unclassified\n\n\nOTU_1\nBacteria\nActinobacteria\nActinobacteria\nActinomycetales\nActinomycetaceae\nActinobaculum\nActinobaculum_massiliense\n\n\nOTU_2\nBacteria\nActinobacteria\nActinobacteria\nActinomycetales\nActinomycetaceae\nActinobaculum\nActinobaculum_schaalii\n\n\nOTU_3\nBacteria\nActinobacteria\nActinobacteria\nActinomycetales\nActinomycetaceae\nActinobaculum\nActinobaculum_unclassified\n\n\nOTU_4\nBacteria\nActinobacteria\nActinobacteria\nActinomycetales\nActinomycetaceae\nActinomyces\nActinomyces_cardiffensis\n\n\n\n\n\n\n\n\n\nSample table\n\n\n\n\n\n\n\n\n\nbody_site\nstudy_condition\ndisease\nage\nage_category\ngender\ncountry\n\n\nsubjectID\n\n\n\n\n\n\n\n\n\n\n\nFR-001\nstool\ncontrol\nnone\n52\nadult\nfemale\nFRA\n\n\nFR-003\nstool\ncontrol\nnone\n70\nsenior\nmale\nFRA\n\n\nFR-024\nstool\ncontrol\nnone\n37\nadult\nfemale\nFRA\n\n\nFR-025\nstool\ncontrol\nnone\n80\nsenior\nfemale\nFRA\n\n\nFR-026\nstool\nadenoma\nadenoma\n66\nsenior\nmale\nFRA"
  },
  {
    "objectID": "posts/post-with-code/meta_analysis.html#visualizing-species-distribution-between-healthy-and-crc-patients",
    "href": "posts/post-with-code/meta_analysis.html#visualizing-species-distribution-between-healthy-and-crc-patients",
    "title": "Metagenomic Analysis of Gut Microbiome for their Association with Colorectal Cancer",
    "section": "Visualizing species distribution between healthy and CRC patients",
    "text": "Visualizing species distribution between healthy and CRC patients\nWe will now visualize the distribution of species in the dataset among healthy and CRC patients.\nFor that we will first aggregate data on family level. The table below shows aggregated abundance at phylum rank.\n\n\n\n\n\n\n\n\n\nAcidobacteria\nActinobacteria\nBacteroidetes\nCandidatus_Saccharibacteria\nDeferribacteres\nDeinococcus_Thermus\nFirmicutes\nFusobacteria\nProteobacteria\nSpirochaetes\nSynergistetes\nVerrucomicrobia\n\n\nsubjectID\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFR-001\n0.0\n0.00000\n17.89904\n0.00000\n0.0\n0.0\n72.93033\n0.0\n0.61829\n0.0\n0.0\n0.55267\n\n\nFR-003\n0.0\n0.13650\n30.21824\n0.01474\n0.0\n0.0\n69.06778\n0.0\n0.55140\n0.0\n0.0\n0.00000\n\n\nFR-024\n0.0\n13.87554\n26.19035\n0.00000\n0.0\n0.0\n59.25760\n0.0\n0.67171\n0.0\n0.0\n0.00000\n\n\nFR-025\n0.0\n9.51098\n16.21552\n0.00000\n0.0\n0.0\n71.98672\n0.0\n2.28680\n0.0\n0.0\n0.00000\n\n\nFR-026\n0.0\n0.41172\n25.24277\n0.00532\n0.0\n0.0\n58.92459\n0.0\n1.17038\n0.0\n0.0\n0.00000\n\n\n\n\n\n\n\n\nDistribution at phylum level\nThe below figures visualize the distribution of gut microbiome at phylum rank. We can use these plots to select particular phylum for our further analysis. For example, it can clearly seen that Bacteroides and Firnicutes are two most abundand phylum in the dataset.\n\nShow the code\nphylum_df = phylum_agg.merge(sample_table, left_index=True, right_index=True)\nfrom plotnine import ggplot, aes, geom_boxplot, theme_minimal, labs, facet_wrap\nimport matplotlib.pyplot as plt\n\nmy_pal = {\"control\": \"g\", \"adenoma\": \"b\", \"CRC\":\"r\"}\n\nfor ph in phylum_agg.columns:\n    plt.figure()\n    sns.boxplot(x='study_condition', y=ph, data=phylum_df, palette=my_pal, saturation=0.2, hue='study_condition')\n    plt.title('{} distribution'.format(ph))\n    plt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n(a) Acidobacteria\n\n\n\n\n\n\n\n\n\n\n\n(b) Actinobacteria\n\n\n\n\n\n\n\n\n\n\n\n(c) Bacteroidetes\n\n\n\n\n\n\n\n\n\n\n\n\n\n(d) Candidatus_Saccharibacteria\n\n\n\n\n\n\n\n\n\n\n\n(e) Deferribacteres\n\n\n\n\n\n\n\n\n\n\n\n(f) Deinococcus_Thermus\n\n\n\n\n\n\n\n\n\n\n\n\n\n(g) Firmicutes\n\n\n\n\n\n\n\n\n\n\n\n(h) Fusobacteria\n\n\n\n\n\n\n\n\n\n\n\n(i) Proteobacteria\n\n\n\n\n\n\n\n\n\n\n\n\n\n(j) Spirochaetes\n\n\n\n\n\n\n\n\n\n\n\n(k) Synergistetes\n\n\n\n\n\n\n\n\n\n\n\n(l) Verrucomicrobia\n\n\n\n\n\n\n\nFigure 1: Distribution at phylum rank\n\n\n\nLet’s move forward with visualization and plot species level distribution for aforemention phylums.\n\n\nDistribution at genus level\nAt this phase, we filtered out genus with less than 3% abundance. Then we plotted distribution at genus level for healthy, adenoma and CRC patients. The figures below show distriution of 8 different types of genus in the dataset whose relative abundance satisfied the criteria (&gt;3%).\n\nShow the code\nfilter_phylum = taxa_table.loc[taxa_table['phylum'].isin(['Bacteroidetes', 'Firmicutes']),:]\n\ngenus_fil = aggregate_by_taxonomy(otu_table,filter_phylum,'genus')\n\ngenus_abund = genus_fil.mean(axis=0).to_dict()\ngenus_list = []\n\nfor genus, value in genus_abund.items():\n    if value &gt; 3:\n        genus_list.append(genus)\n\ngenus_new = genus_fil[genus_list]\n\ngenus_fil_df = genus_new.merge(sample_table, left_index=True, right_index=True)\n\n\nfor ph in genus_new.columns:\n    plt.figure()\n    sns.boxplot(x='study_condition', y=ph, data=genus_fil_df, palette=my_pal, saturation=0.2, hue='study_condition')\n    plt.title('{} distribution'.format(ph))\n    plt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n(a) Bacteroides\n\n\n\n\n\n\n\n\n\n\n\n(b) Prevotella\n\n\n\n\n\n\n\n\n\n\n\n(c) Eubacterium\n\n\n\n\n\n\n\n\n\n\n\n\n\n(d) Blautia\n\n\n\n\n\n\n\n\n\n\n\n(e) Coprococcus\n\n\n\n\n\n\n\n\n\n\n\n(f) Faecalibacterium\n\n\n\n\n\n\n\n\n\n\n\n\n\n(g) Ruminococcus\n\n\n\n\n\n\n\n\n\n\n\n(h) Subdoligranulum\n\n\n\n\n\n\n\nFigure 2: Distribution at genus rank\n\n\n\n\n\nStatistical significance\nBased on our understanding of different taxa at the genus level, we filtered out 8 different types of genus for our statistical analysis. We will use Kruska Wallis statistical test for testing the null hypothesis that the medians of relative abundance of microbial organisms of our selected genus levels are same.\nThere are two different genus (Eubacterium and Ruminococcus) whose differences among healthy, adenoma and CRC patients were found statistically significant.\n\n\n\nGenus\np_value\n\n\n\n\nBacteroides\n0.195\n\n\nPrevotella\n0.237\n\n\nEubacterium\n0.000\n\n\nBlautia\n0.479\n\n\nCoprococcus\n0.063\n\n\nFaecalibacterium\n0.131\n\n\nRuminococcus\n0.004\n\n\nSubdoligranulum\n0.365\n\n\n\n\n\nAlpha diversity\nWe will now investigate whether their are any differences between healthy, adenoma and CRC patients in terms of alpha diversity.\n\nShow the code\nfor ph in alpha_diversity_metrics:\n    plt.figure()\n    sns.boxplot(x='study_condition', y=ph, data=diversity_df, palette=my_pal, saturation=0.2, hue='study_condition')\n    plt.title('{} metric'.format(ph))\n    plt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n(a) chao1\n\n\n\n\n\n\n\n\n\n\n\n(b) shannon\n\n\n\n\n\n\n\n\n\n\n\n(c) simpson\n\n\n\n\n\n\n\n\n\n\n\n\n\n(d) simpson_e\n\n\n\n\n\n\n\n\n\n\n\n(e) fisher_alpha\n\n\n\n\n\n\n\n\n\n\n\n(f) berger_parker\n\n\n\n\n\n\n\nFigure 3: Alpha diversity measures"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "bioinformatics",
    "section": "",
    "text": "Metagenomic Analysis of Gut Microbiome for their Association with Colorectal Cancer\n\n\n\n\n\n\npython\n\n\nbioinformatics\n\n\nmetagenomics\n\n\ncolorectal cancer\n\n\n\n\n\n\n\n\n\nNov 19, 2024\n\n\nPankaj Chejara\n\n\n\n\n\n\nNo matching items"
  }
]